{"id":"perplexity-cli-dm3","title":"Build Perplexity CLI Application","description":"Build a Go CLI using Cobra for the Perplexity Sonar API with one-shot queries (pplx run), interactive REPL mode (pplx), session persistence in ~/.pplx/sessions/, and session management commands (pplx session search, pplx session -l). Default model: sonar. API key from PPLX_API_KEY env var. Citations formatted as bracket numbers at end of sentences.","status":"closed","priority":2,"issue_type":"epic","created_at":"2026-02-10T20:41:44.638353-03:00","created_by":"adrielmartins","updated_at":"2026-02-10T20:51:10.626321-03:00","closed_at":"2026-02-10T20:51:10.626321-03:00","close_reason":"Closed"}
{"id":"perplexity-cli-dm3.1","title":"Step 1: Project Setup and Dependencies","description":"Initialize Go module and install Cobra framework. Files: go.mod, go.sum, main.go, cmd/root.go. Install dependencies: cobra, viper. Run 'go mod init github.com/user/perplexity-cli' and 'go get github.com/spf13/cobra github.com/spf13/viper'.\n\nAC:\n- go.mod exists with module name\n- cobra and viper in go.sum\n- main.go with basic cobra setup\n- cmd/root.go with root command","status":"closed","priority":0,"issue_type":"task","created_at":"2026-02-10T20:42:01.586496-03:00","created_by":"adrielmartins","updated_at":"2026-02-10T20:44:59.735244-03:00","closed_at":"2026-02-10T20:44:59.735244-03:00","close_reason":"Closed","dependencies":[{"issue_id":"perplexity-cli-dm3.1","depends_on_id":"perplexity-cli-dm3","type":"parent-child","created_at":"2026-02-10T20:42:01.587186-03:00","created_by":"adrielmartins"}]}
{"id":"perplexity-cli-dm3.10","title":"Step 10: Testing and Build","description":"Write tests and create build configuration. Files: various *_test.go, Makefile.\n\nKey implementation:\n- Unit tests for citation parsing with various formats\n- Unit tests for session file read/write operations\n- Unit tests for API client with mock responses\n- Integration tests for end-to-end flows\n- Makefile with targets: build, test, install, clean\n- Test API client by mocking HTTP responses\n- Test session management with temp directories\n\nAC:\n- Tests pass: go test ./...\n- make build produces binary\n- make test runs all tests\n- Binary can be installed locally","status":"closed","priority":0,"issue_type":"task","created_at":"2026-02-10T20:42:11.514384-03:00","created_by":"adrielmartins","updated_at":"2026-02-10T20:51:10.556536-03:00","closed_at":"2026-02-10T20:51:10.556536-03:00","close_reason":"Closed","dependencies":[{"issue_id":"perplexity-cli-dm3.10","depends_on_id":"perplexity-cli-dm3","type":"parent-child","created_at":"2026-02-10T20:42:11.51491-03:00","created_by":"adrielmartins"},{"issue_id":"perplexity-cli-dm3.10","depends_on_id":"perplexity-cli-dm3.4","type":"blocks","created_at":"2026-02-10T20:42:17.809591-03:00","created_by":"adrielmartins"},{"issue_id":"perplexity-cli-dm3.10","depends_on_id":"perplexity-cli-dm3.5","type":"blocks","created_at":"2026-02-10T20:42:17.990501-03:00","created_by":"adrielmartins"},{"issue_id":"perplexity-cli-dm3.10","depends_on_id":"perplexity-cli-dm3.6","type":"blocks","created_at":"2026-02-10T20:42:18.196134-03:00","created_by":"adrielmartins"},{"issue_id":"perplexity-cli-dm3.10","depends_on_id":"perplexity-cli-dm3.7","type":"blocks","created_at":"2026-02-10T20:42:18.358459-03:00","created_by":"adrielmartins"},{"issue_id":"perplexity-cli-dm3.10","depends_on_id":"perplexity-cli-dm3.8","type":"blocks","created_at":"2026-02-10T20:42:18.535792-03:00","created_by":"adrielmartins"}]}
{"id":"perplexity-cli-dm3.2","title":"Step 2: Create Core API Client","description":"Build lightweight Perplexity API client for chat completions with citation support. Files: pkg/perplexity/client.go, pkg/perplexity/types.go, pkg/perplexity/citations.go.\n\nKey implementation:\n- API endpoint: https://api.perplexity.ai/chat/completions\n- HTTP client with Bearer token auth (PPLX_API_KEY)\n- Request/response structs matching Perplexity API format\n- Citation extraction using regex pattern \\[\\d+\\] to find citations like [1], [2]\n- Map citations to search_results array by index\n- Format references with # References heading at end\n\nAC:\n- Client can make API calls\n- Types match Perplexity API schema\n- Citation parser extracts bracket numbers\n- References formatted correctly","status":"closed","priority":0,"issue_type":"task","created_at":"2026-02-10T20:42:02.967231-03:00","created_by":"adrielmartins","updated_at":"2026-02-10T20:45:33.693454-03:00","closed_at":"2026-02-10T20:45:33.693454-03:00","close_reason":"Closed","dependencies":[{"issue_id":"perplexity-cli-dm3.2","depends_on_id":"perplexity-cli-dm3","type":"parent-child","created_at":"2026-02-10T20:42:02.967746-03:00","created_by":"adrielmartins"},{"issue_id":"perplexity-cli-dm3.2","depends_on_id":"perplexity-cli-dm3.1","type":"blocks","created_at":"2026-02-10T20:42:14.505059-03:00","created_by":"adrielmartins"}]}
{"id":"perplexity-cli-dm3.3","title":"Step 3: Session Management System","description":"Implement JSON session storage with timestamp-based filenames. Files: pkg/session/manager.go, pkg/session/types.go, pkg/session/utils.go.\n\nKey implementation:\n- Storage path: ~/.pplx/sessions/\n- Filename format: 20060102-150405.000.json (Go time format with milliseconds)\n- Session JSON structure: timestamp, messages array (role/content), metadata (model, initial_query)\n- CRUD operations: Create, Read, Update (append), List\n- Directory creation if doesn't exist\n- Atomic file writes (temp then rename)\n\nAC:\n- Session files created with correct format\n- JSON structure includes all required fields\n- Directory auto-created\n- Can read and write sessions","status":"closed","priority":0,"issue_type":"task","created_at":"2026-02-10T20:42:03.890479-03:00","created_by":"adrielmartins","updated_at":"2026-02-10T20:46:05.941959-03:00","closed_at":"2026-02-10T20:46:05.941959-03:00","close_reason":"Closed","dependencies":[{"issue_id":"perplexity-cli-dm3.3","depends_on_id":"perplexity-cli-dm3","type":"parent-child","created_at":"2026-02-10T20:42:03.890988-03:00","created_by":"adrielmartins"},{"issue_id":"perplexity-cli-dm3.3","depends_on_id":"perplexity-cli-dm3.1","type":"blocks","created_at":"2026-02-10T20:42:14.62992-03:00","created_by":"adrielmartins"}]}
{"id":"perplexity-cli-dm3.4","title":"Step 4: Implement pplx run Command","description":"Create one-shot query command. File: cmd/run.go.\n\nCommand syntax: pplx run \"query string\" [--model sonar]\n\nKey implementation:\n- Accept query as positional argument\n- Make single API call with messages array containing user query only\n- Display content with citations inline (e.g., \"Paris is the capital of France. [1]\")\n- Add # References section at end with numbered list mapping to URLs\n- Support --model flag to override default\n- Save session after completion\n- Handle API errors gracefully\n\nAC:\n- pplx run \"What is 2+2?\" works\n- Output includes citations and references\n- Session file created after execution\n- --model flag works","status":"closed","priority":0,"issue_type":"task","created_at":"2026-02-10T20:42:04.988614-03:00","created_by":"adrielmartins","updated_at":"2026-02-10T20:46:49.621518-03:00","closed_at":"2026-02-10T20:46:49.621518-03:00","close_reason":"Closed","dependencies":[{"issue_id":"perplexity-cli-dm3.4","depends_on_id":"perplexity-cli-dm3","type":"parent-child","created_at":"2026-02-10T20:42:04.989182-03:00","created_by":"adrielmartins"},{"issue_id":"perplexity-cli-dm3.4","depends_on_id":"perplexity-cli-dm3.2","type":"blocks","created_at":"2026-02-10T20:42:14.774051-03:00","created_by":"adrielmartins"},{"issue_id":"perplexity-cli-dm3.4","depends_on_id":"perplexity-cli-dm3.3","type":"blocks","created_at":"2026-02-10T20:42:15.256661-03:00","created_by":"adrielmartins"}]}
{"id":"perplexity-cli-dm3.5","title":"Step 5: Implement Interactive Mode (pplx)","description":"Build REPL-style interactive session. File: cmd/interactive.go or integrate in root.go.\n\nBehavior: When pplx called with no arguments, enter interactive mode.\n\nKey implementation:\n- Display prompt: You:\n- Read line-by-line using bufio.Scanner\n- Exit commands: /q, /quit, ctrl+c (handle SIGINT with signal.Notify)\n- Maintain conversation history in memory as message array\n- CRITICAL: Strip references section from assistant messages before adding to API context\n- Auto-save session after each exchange\n- Format output: PPLX: \u003ccontent with citations\u003e\\n\\n## References:\\n[1] \u003ctitle\u003e - \u003curl\u003e\n- Handle multi-line input elegantly\n- Limit context window to last N messages (default 20)\n\nAC:\n- pplx with no args enters REPL\n- Can have back-and-forth conversation\n- /q and ctrl+c exit cleanly\n- Session auto-saves\n- References not sent in API context","status":"closed","priority":0,"issue_type":"task","created_at":"2026-02-10T20:42:06.473029-03:00","created_by":"adrielmartins","updated_at":"2026-02-10T20:47:12.617313-03:00","closed_at":"2026-02-10T20:47:12.617313-03:00","close_reason":"Closed","dependencies":[{"issue_id":"perplexity-cli-dm3.5","depends_on_id":"perplexity-cli-dm3","type":"parent-child","created_at":"2026-02-10T20:42:06.473641-03:00","created_by":"adrielmartins"},{"issue_id":"perplexity-cli-dm3.5","depends_on_id":"perplexity-cli-dm3.2","type":"blocks","created_at":"2026-02-10T20:42:15.386127-03:00","created_by":"adrielmartins"},{"issue_id":"perplexity-cli-dm3.5","depends_on_id":"perplexity-cli-dm3.3","type":"blocks","created_at":"2026-02-10T20:42:15.536136-03:00","created_by":"adrielmartins"}]}
{"id":"perplexity-cli-dm3.6","title":"Step 6: Implement Session Search Command","description":"Create pplx session search command. Files: cmd/session.go (parent), cmd/session_search.go.\n\nCommand syntax: pplx session search \"search term\"\n\nKey implementation:\n- Parent session command with subcommands\n- Search through ~/.pplx/sessions/*.json files\n- Use Go's os.ReadDir and strings.Contains for search (no external grep needed)\n- Case-insensitive search by default\n- Return matching filenames with context (show first query or matching snippet)\n- Support regex patterns (optional/advanced)\n\nAC:\n- pplx session search \"France\" finds relevant sessions\n- Output shows filenames and context\n- Case-insensitive by default\n- Works with partial matches","status":"closed","priority":0,"issue_type":"task","created_at":"2026-02-10T20:42:07.497152-03:00","created_by":"adrielmartins","updated_at":"2026-02-10T20:47:35.79578-03:00","closed_at":"2026-02-10T20:47:35.79578-03:00","close_reason":"Closed","dependencies":[{"issue_id":"perplexity-cli-dm3.6","depends_on_id":"perplexity-cli-dm3","type":"parent-child","created_at":"2026-02-10T20:42:07.497704-03:00","created_by":"adrielmartins"},{"issue_id":"perplexity-cli-dm3.6","depends_on_id":"perplexity-cli-dm3.3","type":"blocks","created_at":"2026-02-10T20:42:15.734603-03:00","created_by":"adrielmartins"}]}
{"id":"perplexity-cli-dm3.7","title":"Step 7: Implement Session List Command","description":"Create pplx session list command. File: cmd/session_list.go.\n\nCommand syntax: pplx session -l 10 or pplx session list -n 10\n\nKey implementation:\n- Read all session files from ~/.pplx/sessions/\n- Sort by filename (timestamp) descending (newest first)\n- Display: \u003ctimestamp\u003e - \u003cinitial_query_truncated\u003e\n- Default limit: 10 sessions\n- Support -l/--limit flag for custom count\n- Format: simple list or tabular output\n\nAC:\n- pplx session -l 10 lists 10 most recent sessions\n- Sorted by timestamp descending\n- Shows initial query preview\n- Flag works for custom limits","status":"closed","priority":0,"issue_type":"task","created_at":"2026-02-10T20:42:08.517217-03:00","created_by":"adrielmartins","updated_at":"2026-02-10T20:47:54.091807-03:00","closed_at":"2026-02-10T20:47:54.091807-03:00","close_reason":"Closed","dependencies":[{"issue_id":"perplexity-cli-dm3.7","depends_on_id":"perplexity-cli-dm3","type":"parent-child","created_at":"2026-02-10T20:42:08.517919-03:00","created_by":"adrielmartins"},{"issue_id":"perplexity-cli-dm3.7","depends_on_id":"perplexity-cli-dm3.3","type":"blocks","created_at":"2026-02-10T20:42:15.888983-03:00","created_by":"adrielmartins"}]}
{"id":"perplexity-cli-dm3.8","title":"Step 8: Configuration and Environment Setup","description":"Add configuration management and API key handling. File: pkg/config/config.go.\n\nKey implementation:\n- Read API key from PPLX_API_KEY environment variable (primary method)\n- Support optional config file at ~/.pplx/config.yaml for defaults\n- Config options: default_model, max_tokens, temperature, search_context_size\n- Validate API key presence on startup\n- Load config using Viper\n- Create ~/.pplx directory structure on first run\n\nAC:\n- PPLX_API_KEY env var works\n- Config file loads if present\n- Defaults set for all options\n- Clear error if API key missing","status":"closed","priority":0,"issue_type":"task","created_at":"2026-02-10T20:42:09.438083-03:00","created_by":"adrielmartins","updated_at":"2026-02-10T20:46:28.457743-03:00","closed_at":"2026-02-10T20:46:28.457743-03:00","close_reason":"Closed","dependencies":[{"issue_id":"perplexity-cli-dm3.8","depends_on_id":"perplexity-cli-dm3","type":"parent-child","created_at":"2026-02-10T20:42:09.438553-03:00","created_by":"adrielmartins"},{"issue_id":"perplexity-cli-dm3.8","depends_on_id":"perplexity-cli-dm3.1","type":"blocks","created_at":"2026-02-10T20:42:16.241326-03:00","created_by":"adrielmartins"}]}
{"id":"perplexity-cli-dm3.9","title":"Step 9: Error Handling and User Experience","description":"Add comprehensive error handling and UX improvements. Modify all command files.\n\nKey implementation:\n- Graceful API error handling (rate limits, auth failures, network issues)\n- Clear error messages for missing API key\n- Progress indicators for API calls (spinner or \"Thinking...\")\n- Signal handling for clean shutdown (SIGINT, SIGTERM)\n- Colorized output using fatih/color (optional but nice)\n- Comprehensive --help documentation for all commands\n- Input validation (empty queries, etc.)\n\nAC:\n- API errors show helpful messages\n- Missing API key error is clear\n- Ctrl+C exits gracefully and saves session\n- All commands have good help text\n- Colors used appropriately","status":"closed","priority":0,"issue_type":"task","created_at":"2026-02-10T20:42:10.673309-03:00","created_by":"adrielmartins","updated_at":"2026-02-10T20:49:17.598026-03:00","closed_at":"2026-02-10T20:49:17.598026-03:00","close_reason":"Closed","dependencies":[{"issue_id":"perplexity-cli-dm3.9","depends_on_id":"perplexity-cli-dm3","type":"parent-child","created_at":"2026-02-10T20:42:10.673871-03:00","created_by":"adrielmartins"},{"issue_id":"perplexity-cli-dm3.9","depends_on_id":"perplexity-cli-dm3.4","type":"blocks","created_at":"2026-02-10T20:42:16.398617-03:00","created_by":"adrielmartins"},{"issue_id":"perplexity-cli-dm3.9","depends_on_id":"perplexity-cli-dm3.5","type":"blocks","created_at":"2026-02-10T20:42:16.883938-03:00","created_by":"adrielmartins"},{"issue_id":"perplexity-cli-dm3.9","depends_on_id":"perplexity-cli-dm3.6","type":"blocks","created_at":"2026-02-10T20:42:17.066601-03:00","created_by":"adrielmartins"},{"issue_id":"perplexity-cli-dm3.9","depends_on_id":"perplexity-cli-dm3.7","type":"blocks","created_at":"2026-02-10T20:42:17.357303-03:00","created_by":"adrielmartins"},{"issue_id":"perplexity-cli-dm3.9","depends_on_id":"perplexity-cli-dm3.8","type":"blocks","created_at":"2026-02-10T20:42:17.622084-03:00","created_by":"adrielmartins"}]}
